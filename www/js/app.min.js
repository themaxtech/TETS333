/* Modified: December 3, 2014, 03:52:27 */
!function(){function a(){D.setAttribute("disabled","disabled"),D.setAttribute("placeholder","Your ID: "+B),F.style.display="inline-block",G.style.display="block"}function b(){D.removeAttribute("disabled"),D.setAttribute("placeholder","Enter your Device ID"),F.style.display="none",G.style.display="none"}function c(a){a.preventDefault(),a.stopPropagation();var b=a.deltaY||a.detail;b>5&&(b=5),-5>b&&(b=-5),l+=b/100,0>l&&(l=0),l>.85&&(l=.85),d(l)}function d(a){w.attr("d",s.endAngle(k*a)),w.attr("fill",r(a)),C=q(a).toFixed(0),x.text(C+"Â°"),80>C?x.attr("fill","#666"):x.attr("fill",r(a)),B&&A&&(window.clearTimeout(v),v=window.setTimeout(e,7e3))}function e(){console.log(C),y.publish({channel:B,message:{regid:A,setting:C}}),C>=80&&h()}function f(c){13===(c.keyCode||c.charCode)&&(B=D.value,D.value="",y.history({channel:B,count:2,callback:function(c){console.log(c),c[0][0]&&c[0][0].regid||c[0][1]&&c[0][1].regid?(A=c[0][0].regid||c[0][1].regid,console.log(A),localStorage.setItem("notify-demo-channel",B),localStorage.setItem("notify-demo-regid",A),a(),B.length<8&&(z="ios")):(alert("The ID you entered, "+B+" does not match with any devices"),b())}}))}function g(){localStorage.setItem("notify-demo-channel",""),localStorage.setItem("notify-demo-regid",""),b();var a="ios"===z?"apns":"gcm";y.mobile_gw_provision({device_id:A,channel:B,op:"remove",gw_type:a,callback:function(a){console.log(a)}}),A=""}function h(){console.log("sending push notification...");var a="ios"===z?"apns":"gcm";y.mobile_gw_provision({device_id:A,channel:B,op:"add",gw_type:a,error:function(a){console.log(a)},callback:function(){var a=PNmessage();a.pubnub=y,a.callback=function(a){console.log(a)},a.error=function(a){console.log(a)},a.channel=B,a.apns={alert:"The room temperature is set too high"},a.gcm={title:"PubNub Push Demo",message:"The room temperature is set too high"},a.publish()}})}var i=300,j=300,k=2*Math.PI,l=.4,m=40,n=95,o="#F0CA78",p="#F0788C",q=d3.interpolateNumber(m,n),r=d3.interpolate(o,p),s=d3.svg.arc().startAngle(0).innerRadius(120).outerRadius(150),t=d3.select(".container").append("svg").attr("width",i).attr("height",j).append("g").attr("transform","translate("+i/2+","+j/2+")"),u=t.append("g").attr("class","progress-meter");u.append("path").attr("class","background").attr("d",s.endAngle(k));var v,w=u.append("path").attr("class","foreground"),x=u.append("text").attr("x",12).attr("y",38).attr("class","degree").attr("text-anchor","middle"),y=(u.append("text").text("HEAT SET TO").attr("x",2).attr("y",-40).attr("class","subtext").attr("text-anchor","middle"),PUBNUB.init({subscribe_key:"sub-c-f762fb78-2724-11e4-a4df-02ee2ddab7fe",publish_key:"pub-c-156a6d5f-22bd-4a13-848d-b5b4d4b36695"})),z="android",A="",B="",C=0,D=document.getElementById("channel"),E=document.querySelector(".container"),F=document.querySelector(".fa-check-circle"),G=document.querySelector(".revoke");E.addEventListener("mousewheel",c,!1),E.addEventListener("DOMMouseScroll",c,!1),D.addEventListener("keyup",f,!1),G.addEventListener("click",g,!1),localStorage.getItem("notify-demo-channel")&&localStorage.getItem("notify-demo-regid")&&(B=localStorage.getItem("notify-demo-channel"),A=localStorage.getItem("notify-demo-regid"),a(),B.length<8&&(z="ios")),d(l)}();